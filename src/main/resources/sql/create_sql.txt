-- db 존재하면 삭제
drop database if exists coffee;
drop user 'user_coffee'@'%' ;

-- db 생성
create database coffee;

-- db 사용
use coffee;

-- 제품정보
CREATE TABLE product (
   code CHAR(4)  NOT NULL,
   name VARCHAR(20) not null,
   price INT(11) NOT NULL,
   primary key (code)
);

-- 판매정보
CREATE TABLE sale (
   no   INT(11) auto_increment,
   code       CHAR(4) NOT NULL, 
   saleCnt    INT(11) NOT NULL,
   marginRate INT(11) NOT NULL,
   primary key (no),
   FOREIGN KEY (code) REFERENCES product (code)
);

-- create and grant user
-- coffee_project데이터베이스에 select, insert, update, delete, trigger 권한을 계정생성과 부여
grant select, insert, update, delete, trigger on coffee.* to 'user_coffee' identified by 'rootroot';
-- 해당 계정에 procedure 실행 권한부여
GRANT Select ON mysql.proc TO 'user_coffee'@'%' ; 
